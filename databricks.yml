bundle:
  name: mcp_chatgpt_agentbricks_bundle

variables:
  # Agent endpoint name - used for serving endpoint resource
  # Note: This variable is also hardcoded in src/app/app.yaml because
  # DAB variable substitution does not work in app.yaml files
  agent_endpoint_name:
    default: my-agent-endpoint

resources:
  apps:
    mcp_chatgpt_agentbricks:
      name: mcp-chatgpt-agentbricks
      description: A Databricks custom MCP server app to enable ChatGPT to call Databricks Agent Bricks endpoints
      source_code_path: src/app
      user_api_scopes:
        - serving.serving-endpoints
      resources:
        - name: serving-endpoint
          serving_endpoint:
            name: ${var.agent_endpoint_name}
            permission: CAN_QUERY

targets:
  dev:
    mode: development
    default: true
    workspace:
      host: https://adb-xxxxxxxxxxxx.xx.azuredatabricks.net/
  prod:
    mode: production
    workspace:
      host: https://adb-xxxxxxxxxxxx.xx.azuredatabricks.net/
      root_path: /Workspace/Users/${workspace.current_user.userName}/.bundle/${bundle.name}/${bundle.target}
    permissions:
      - user_name: ${workspace.current_user.userName}
        level: CAN_MANAGE